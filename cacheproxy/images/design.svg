<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="678px" preserveAspectRatio="none" style="width:848px;height:678px;background:#FFFFFF;" version="1.1" viewBox="0 0 848 678" width="848px" zoomAndPan="magnify"><defs><filter height="300%" id="fez32yke9b9qf" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="67" x2="67" y1="104.9766" y2="577.9453"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="217" x2="217" y1="104.9766" y2="577.9453"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="366" x2="366" y1="104.9766" y2="577.9453"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="553.5" x2="553.5" y1="104.9766" y2="577.9453"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="744.5" x2="744.5" y1="104.9766" y2="577.9453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="10" y="85.5352">Non-SMF Client</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="118" x="5" y="102.0234">(AMQP/MQTT/...)</text><ellipse cx="67" cy="15" fill="#FEFECE" filter="url(#fez32yke9b9qf)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M67,23 L67,50 M54,31 L80,31 M67,50 L54,65 M67,50 L80,65 " fill="none" filter="url(#fez32yke9b9qf)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="10" y="590.4805">Non-SMF Client</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="118" x="5" y="606.9688">(AMQP/MQTT/...)</text><ellipse cx="67" cy="619.9219" fill="#FEFECE" filter="url(#fez32yke9b9qf)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M67,627.9219 L67,654.9219 M54,635.9219 L80,635.9219 M67,654.9219 L54,669.9219 M67,654.9219 L80,669.9219 " fill="none" filter="url(#fez32yke9b9qf)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FEFECE" filter="url(#fez32yke9b9qf)" height="46.9766" style="stroke:#A80036;stroke-width:1.5;" width="112" x="159" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="194" y="73.5352">TOPIC</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="166" y="90.0234">cache/request</text><rect fill="#FEFECE" filter="url(#fez32yke9b9qf)" height="46.9766" style="stroke:#A80036;stroke-width:1.5;" width="112" x="159" y="576.9453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="194" y="597.4805">TOPIC</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="166" y="613.9688">cache/request</text><rect fill="#FEFECE" filter="url(#fez32yke9b9qf)" height="46.9766" style="stroke:#A80036;stroke-width:1.5;" width="158" x="285" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="343" y="73.5352">TOPIC</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="144" x="292" y="90.0234">inbox/my-unique-id</text><rect fill="#FEFECE" filter="url(#fez32yke9b9qf)" height="46.9766" style="stroke:#A80036;stroke-width:1.5;" width="158" x="285" y="576.9453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="343" y="597.4805">TOPIC</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="144" x="292" y="613.9688">inbox/my-unique-id</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="508.5" y="85.5352">Microservice</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="508.5" y="102.0234">Cache Proxy</text><ellipse cx="554" cy="56" fill="#FEFECE" filter="url(#fez32yke9b9qf)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="550,44,556,39,554,44,556,49,550,44" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="508.5" y="590.4805">Microservice</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="508.5" y="606.9688">Cache Proxy</text><ellipse cx="554" cy="625.9219" fill="#FEFECE" filter="url(#fez32yke9b9qf)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="550,613.9219,556,608.9219,554,613.9219,556,618.9219,550,613.9219" style="stroke:#A80036;stroke-width:1.0;"/><rect fill="#FEFECE" filter="url(#fez32yke9b9qf)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="87" x="701.5" y="65.4883"/><rect fill="#FEFECE" filter="url(#fez32yke9b9qf)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="87" x="697.5" y="69.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="704.5" y="90.0234">PS+ Cache</text><rect fill="#FEFECE" filter="url(#fez32yke9b9qf)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="87" x="701.5" y="576.9453"/><rect fill="#FEFECE" filter="url(#fez32yke9b9qf)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="87" x="697.5" y="580.9453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="704.5" y="601.4805">PS+ Cache</text><polygon fill="#A80036" points="733,132.2871,743,136.2871,733,140.2871,737,136.2871" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="554" x2="739" y1="136.2871" y2="136.2871"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="561" y="131.5449">Create Cache Session(SMF)</text><path d="M501,149.2871 L501,204.2871 L793,204.2871 L793,159.2871 L783,149.2871 L501,149.2871 " fill="#FFE0E0" filter="url(#fez32yke9b9qf)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M783,149.2871 L783,159.2871 L793,159.2871 L783,149.2871 " fill="#FFE0E0" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="244" x="507" y="166.8555">Specify the name of the PS+ cache, the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="261" x="507" y="182.166">maximum number of messages per Topic</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="271" x="507" y="197.4766">and the maximum message age in seconds</text><polygon fill="#A80036" points="228,231.5293,218,235.5293,228,239.5293,224,235.5293" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="222" x2="553" y1="235.5293" y2="235.5293"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="234" y="230.7871">Subscribe to</text><rect fill="#EEEEEE" filter="url(#fez32yke9b9qf)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="841" x="0" y="256.5293"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="841" y1="256.5293" y2="256.5293"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="841" y1="259.5293" y2="259.5293"/><polygon fill="#A80036" points="354,290.8398,364,294.8398,354,298.8398,358,294.8398" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="67" x2="360" y1="294.8398" y2="294.8398"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="74" y="290.0977">Subscribe to</text><polygon fill="#C9FFC9" filter="url(#fez32yke9b9qf)" points="381,276.5293,462,276.5293,472,287.5293,462,299.5293,381,299.5293,371,287.5293,381,276.5293" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="383" y="293.0977">"inbox/123"</text><polygon fill="#A80036" points="205,322.1504,215,326.1504,205,330.1504,209,326.1504" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="67" x2="211" y1="326.1504" y2="326.1504"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="74" y="321.4082">Send Cache Request</text><polygon fill="#C9FFC9" filter="url(#fez32yke9b9qf)" points="19,339.1504,264,339.1504,274,373.1504,264,408.1504,19,408.1504,9,373.1504,19,339.1504" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="64.5" y="355.7188">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="76.5" y="371.0293">"topic": "fx/rt/&gt;",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="76.5" y="386.3398">"replyTo": "inbox/123"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="64.5" y="401.6504">}</text><polygon fill="#A80036" points="542,430.7031,552,434.7031,542,438.7031,546,434.7031" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="217" x2="548" y1="434.7031" y2="434.7031"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="224" y="429.9609">Receive cache reqeust</text><polygon fill="#A80036" points="733,462.0137,743,466.0137,733,470.0137,737,466.0137" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="554" x2="739" y1="466.0137" y2="466.0137"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163" x="561" y="461.2715">Send Cache Request (SMF)</text><polygon fill="#C9FFC9" filter="url(#fez32yke9b9qf)" points="760,447.7031,821,447.7031,831,458.7031,821,470.7031,760,470.7031,750,458.7031,760,447.7031" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57" x="762" y="464.2715">"fx/rt/&gt;"</text><polygon fill="#A80036" points="565,493.3242,555,497.3242,565,501.3242,561,497.3242" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="559" x2="744" y1="497.3242" y2="497.3242"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161" x="571" y="492.582">Receive cached messages</text><polygon fill="#A80036" points="377,524.6348,367,528.6348,377,532.6348,373,528.6348" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="371" x2="553" y1="528.6348" y2="528.6348"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="383" y="523.8926">Forward cached messages</text><polygon fill="#C9FFC9" filter="url(#fez32yke9b9qf)" points="270,510.3242,351,510.3242,361,521.3242,351,533.3242,270,533.3242,260,521.3242,270,510.3242" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="272" y="526.8926">"inbox/123"</text><polygon fill="#A80036" points="78,555.9453,68,559.9453,78,563.9453,74,559.9453" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="72" x2="365" y1="559.9453" y2="559.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161" x="84" y="555.2031">Receive cached messages</text><!--MD5=[502fce0134c61c23d9260fad69c56f6f]
@startuml design
actor "Non-SMF Client\n(AMQP/MQTT/...)" as client
participant "TOPIC\ncache/request" as tRequest
participant "TOPIC\ninbox/my-unique-id" as tReply
control     "Microservice\nCache Proxy"     as cp
collections "PS+ Cache" as pscache

cp -> pscache: Create Cache Session(SMF)
note over cp, pscache #Implementation
Specify the name of the PS+ cache, the
maximum number of messages per Topic
and the maximum message age in seconds
end note
cp -> tRequest: Subscribe to
== ==
client -> tReply: Subscribe to 
hnote right #Technology: "inbox/123"
client -> tRequest: Send Cache Request
hnote over client, tRequest #Technology
{
   "topic": "fx/rt/>",
   "replyTo": "inbox/123"
}
end note
tRequest -> cp: Receive cache reqeust
cp -> pscache: Send Cache Request (SMF)
hnote right #Technology: "fx/rt/>"
pscache - -> cp : Receive cached messages
cp -> tReply: Forward cached messages
hnote left #Technology: "inbox/123"
tReply -> client: Receive cached messages
@enduml

PlantUML version 1.2022.0(Wed Jan 12 00:16:42 CST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: CN
--></g></svg>